package io.github.pmckeown.dependencytrack.finding;

import java.util.UUID;

import static org.apache.commons.lang3.RandomStringUtils.randomNumeric;

public class VulnerabilityBuilder {

    private String uuid = UUID.randomUUID().toString();
    private String source = "NVD";
    private String vulnId = "CVE-2016-" + randomNumeric(4);
    private Severity severity = Severity.CRITICAL;
    private String description = "This component prints your password to the logs";

    private VulnerabilityBuilder() {
        // Use builder factory method
    }

    public static VulnerabilityBuilder aVulnerability() {
        return new VulnerabilityBuilder();
    }

    public static VulnerabilityBuilder fixType1Vulnerability() {
        return new VulnerabilityBuilder()
            .withUuid("bfcc58b3-ebea-4dfa-9e98-5a87aed72d96")
            .withSource("GITHUB")
            .withVulnId("GHSA-mg83-c7gq-rv5c");
    }

    public static VulnerabilityBuilder fixType2Vulnerability() {
        return new VulnerabilityBuilder()
            .withUuid("5d849ba6-c808-4469-9dd8-676e0ea1e976")
            .withSource("NVD")
            .withVulnId("CVE-2025-22235");
    }

    public VulnerabilityBuilder withUuid(String uuid) {
        this.uuid = uuid;
        return this;
    }

    public VulnerabilityBuilder withSource(String s) {
        this.source = s;
        return this;
    }

    public VulnerabilityBuilder withVulnId(String vi) {
        this.vulnId = vi;
        return this;
    }

    public VulnerabilityBuilder withSeverity(Severity s) {
        this.severity = s;
        return this;
    }

    public VulnerabilityBuilder withDescription(String d) {
        this.description = d;
        return this;
    }

    public Vulnerability build() {
        return new Vulnerability(uuid, source, vulnId, severity, description);
    }
}
