package io.github.pmckeown.dependencytrack.finding;

import java.util.UUID;

import static org.apache.commons.lang3.RandomStringUtils.randomNumeric;

public class VulnerabilityBuilder {

    private String uuid = UUID.randomUUID().toString();
    private String source = "NVD";
    private String vulnId = "CVE-2016-" + randomNumeric(4);
    private Vulnerability.Severity severity = Vulnerability.Severity.CRITICAL;
    private String description = "This component prints your password to the logs";

    private VulnerabilityBuilder() {
        // Use builder factory method
    }

    public static VulnerabilityBuilder aVulnerability() {
        return new VulnerabilityBuilder();
    }

    public VulnerabilityBuilder withSource(String s) {
        this.source = s;
        return this;
    }

    public VulnerabilityBuilder withVulnId(String vi) {
        this.vulnId = vi;
        return this;
    }

    public VulnerabilityBuilder withSeverity(Vulnerability.Severity s) {
        this.severity = s;
        return this;
    }

    public VulnerabilityBuilder withDescription(String d) {
        this.description = d;
        return this;
    }

    public Vulnerability build() {
        return new Vulnerability(uuid, source, vulnId, severity, description);
    }
}
